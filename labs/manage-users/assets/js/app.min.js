!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";Array.prototype.includes||(Array.prototype.includes=function(a){var b=Object(this),c=parseInt(b.length,10)||0;if(0===c)return!1;var d,e=parseInt(arguments[1],10)||0;e>=0?d=e:(d=c+e,d<0&&(d=0));for(var f;d<c;){if(f=b[d],a===f||a!==a&&f!==f)return!0;d++}return!1});var d=c(1);document.addEventListener("DOMContentLoaded",function(){new d.ManageUsers;document.querySelector("html").classList.add("react")})},function(a,b,c){"use strict";var d=(c(2),c(3)),e=(c(4),c(7)),f=c(17),g=function(){e.subscribe(function(){console.log(e.getState())});var a=(0,d.connect)(function(a,b){return{quickCreate:a.quickCreate,users:a.users.sort(function(a,b){return a.username>b.username?1:-1}),userGroups:a.userGroups,roles:a.roles,fieldsetRoles:a.fieldsetRoles}})(f);ReactDOM.render(React.createElement(d.Provider,{store:e},React.createElement(a,null)),document.getElementById("manage-users-form"))};b.ManageUsers=g},function(a,b){a.exports=Redux},function(a,b){a.exports=ReactRedux},function(a,b,c){"use strict";c(5);var d="update_quickcreate",e=function(a){return{type:d,quickCreate:a}};b.UPDATE_QUICKCREATE=d,b.updateQuickCreate=e;var f="addusergroup",g=function(a){return{type:f,userGroup:a}};b.ADD_USER_GROUP=f,b.addUserGroup=g;var h="addusertogroup",i=function(a,b){return{type:h,id:a,group:b}};b.ADD_USER_TO_GROUP=h,b.addUserToGroup=i;var j="removeuserfromgroup",k=function(a,b){return console.log("ru",a,b),{type:j,id:a,group:b}};b.REMOVE_USER_FROM_GROUP=j,b.removeUserFromGroup=k;var l="updateuser",m="updateusersuccess",n="updateusererror",o=function(a,b){return{type:m,user:b,id:a}},p=function(a,b){return{type:n,user:b,id:a}},q=function(a,b){return function(c){return fetch("/api/user/update",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(b)}).then(function(a){if(a.state<200||a.state>=300){var b=new Error(a.statusText);throw b.response=a,b}return a}).then(function(a){return a.json()}).then(function(d){return c(o(a,b))})["catch"](function(d){return c(p(a,b))})}};b.UPDATE_USER=l,b.UPDATE_USER_SUCCESS=m,b.UPDATE_USER_ERROR=n,b.updateUser=q;var r="addusersuccess",s="addusererror",t=function(a){return{type:r,user:a}},u=function(a){return{type:s,user:a}},v=function(a){return function(b){return fetch("/api/user/add",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(a){if(a.state<200||a.state>=300){var b=new Error(a.statusText);throw b.response=a,b}return a}).then(function(a){return a.json()}).then(function(c){return b(t(a))})["catch"](function(c){return b(u(a))})}};b.ADD_USER_SUCCESS=r,b.ADD_USER_ERROR=s,b.addUser=v;var w="deleteusersuccess",x="deleteusererror",y=function(a){return{type:w,user:a,id:a.id}},z=function(a){return{type:s,user:a,id:a.id}},A=function(a){return function(b){return fetch("/api/user/delete",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(a){if(a.state<200||a.state>=300){var b=new Error(a.statusText);throw b.response=a,b}return a}).then(function(a){return a.json()}).then(function(c){return b(y(a))})["catch"](function(c){return b(z(a))})}};b.DELETE_USER_SUCCESS=w,b.DELETE_USER_ERROR=x,b.deleteUser=A;var B="deleteuserssuccess",C="deleteuserserror",D=function(a){return{type:B,users:a}},E=function(a){return{type:C,users:a}},F=function(a){return console.log("deleteUsers",a),function(b){return fetch("/api/users/delete",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({users:a})}).then(function(a){if(a.state<200||a.state>=300){var b=new Error(a.statusText);throw b.response=a,b}return a}).then(function(a){return a.json()}).then(function(c){return b(D(a))})["catch"](function(c){return b(E(a))})}};b.DELETE_USERS_SUCCESS=B,b.DELETE_USERS_ERROR=C,b.deleteUsers=F;var G="activateuserssuccess",H="activateuserserror",I=function(a){return{type:G,users:a}},J=function(a){return{type:H,users:a}},K=function(a){return console.log("activate",a),function(b){return fetch("/api/users/activate",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({users:a})}).then(function(a){if(a.state<200||a.state>=300){var b=new Error(a.statusText);throw b.response=a,b}return a}).then(function(a){return a.json()}).then(function(c){return b(I(a))})["catch"](function(c){return b(J(a))})}};b.ACTIVATE_USERS_SUCCESS=G,b.ACTIVATE_USERS_ERROR=H,b.activateUsers=K;var L="deactivateuserssuccess",M="deactivateuserserror",N=function(a){return{type:L,users:a}},O=function(a){return{type:M,users:a}},P=function(a){return console.log("activate",a),function(b){return fetch("/api/users/deactivate",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({users:a})}).then(function(a){if(a.state<200||a.state>=300){var b=new Error(a.statusText);throw b.response=a,b}return a}).then(function(a){return a.json()}).then(function(c){return b(N(a))})["catch"](function(c){return b(O(a))})}};b.DEACTIVATE_USERS_SUCCESS=L,b.DEACTIVATE_USERS_ERROR=M,b.deactivateUsers=P;var Q="setroles",R=function(a){return{type:Q,roles:a}};b.SET_ROLES=Q,b.setRoles=R;var S="setusergroups",T=function(a){return{type:S,userGroups:a}};b.SET_USER_GROUPS=S,b.setUserGroups=T},function(a,b,c){c(6),a.exports=self.fetch.bind(self)},function(a,b){!function(a){"use strict";function b(a){if("string"!=typeof a&&(a=String(a)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(a))throw new TypeError("Invalid character in header field name");return a.toLowerCase()}function c(a){return"string"!=typeof a&&(a=String(a)),a}function d(a){var b={next:function(){var b=a.shift();return{done:void 0===b,value:b}}};return p.iterable&&(b[Symbol.iterator]=function(){return b}),b}function e(a){this.map={},a instanceof e?a.forEach(function(a,b){this.append(b,a)},this):a&&Object.getOwnPropertyNames(a).forEach(function(b){this.append(b,a[b])},this)}function f(a){return a.bodyUsed?Promise.reject(new TypeError("Already read")):void(a.bodyUsed=!0)}function g(a){return new Promise(function(b,c){a.onload=function(){b(a.result)},a.onerror=function(){c(a.error)}})}function h(a){var b=new FileReader;return b.readAsArrayBuffer(a),g(b)}function i(a){var b=new FileReader;return b.readAsText(a),g(b)}function j(){return this.bodyUsed=!1,this._initBody=function(a){if(this._bodyInit=a,"string"==typeof a)this._bodyText=a;else if(p.blob&&Blob.prototype.isPrototypeOf(a))this._bodyBlob=a;else if(p.formData&&FormData.prototype.isPrototypeOf(a))this._bodyFormData=a;else if(p.searchParams&&URLSearchParams.prototype.isPrototypeOf(a))this._bodyText=a.toString();else if(a){if(!p.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(a))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof a?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob?(this.blob=function(){var a=f(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(h)},this.text=function(){var a=f(this);if(a)return a;if(this._bodyBlob)return i(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var a=f(this);return a?a:Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function k(a){var b=a.toUpperCase();return q.indexOf(b)>-1?b:a}function l(a,b){b=b||{};var c=b.body;if(l.prototype.isPrototypeOf(a)){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,b.headers||(this.headers=new e(a.headers)),this.method=a.method,this.mode=a.mode,c||(c=a._bodyInit,a.bodyUsed=!0)}else this.url=a;if(this.credentials=b.credentials||this.credentials||"omit",!b.headers&&this.headers||(this.headers=new e(b.headers)),this.method=k(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&c)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(c)}function m(a){var b=new FormData;return a.trim().split("&").forEach(function(a){if(a){var c=a.split("="),d=c.shift().replace(/\+/g," "),e=c.join("=").replace(/\+/g," ");b.append(decodeURIComponent(d),decodeURIComponent(e))}}),b}function n(a){var b=new e,c=(a.getAllResponseHeaders()||"").trim().split("\n");return c.forEach(function(a){var c=a.trim().split(":"),d=c.shift().trim(),e=c.join(":").trim();b.append(d,e)}),b}function o(a,b){b||(b={}),this.type="default",this.status=b.status,this.ok=this.status>=200&&this.status<300,this.statusText=b.statusText,this.headers=b.headers instanceof e?b.headers:new e(b.headers),this.url=b.url||"",this._initBody(a)}if(!a.fetch){var p={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch(a){return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};e.prototype.append=function(a,d){a=b(a),d=c(d);var e=this.map[a];e||(e=[],this.map[a]=e),e.push(d)},e.prototype["delete"]=function(a){delete this.map[b(a)]},e.prototype.get=function(a){var c=this.map[b(a)];return c?c[0]:null},e.prototype.getAll=function(a){return this.map[b(a)]||[]},e.prototype.has=function(a){return this.map.hasOwnProperty(b(a))},e.prototype.set=function(a,d){this.map[b(a)]=[c(d)]},e.prototype.forEach=function(a,b){Object.getOwnPropertyNames(this.map).forEach(function(c){this.map[c].forEach(function(d){a.call(b,d,c,this)},this)},this)},e.prototype.keys=function(){var a=[];return this.forEach(function(b,c){a.push(c)}),d(a)},e.prototype.values=function(){var a=[];return this.forEach(function(b){a.push(b)}),d(a)},e.prototype.entries=function(){var a=[];return this.forEach(function(b,c){a.push([c,b])}),d(a)},p.iterable&&(e.prototype[Symbol.iterator]=e.prototype.entries);var q=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];l.prototype.clone=function(){return new l(this)},j.call(l.prototype),j.call(o.prototype),o.prototype.clone=function(){return new o(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new e(this.headers),url:this.url})},o.error=function(){var a=new o(null,{status:0,statusText:""});return a.type="error",a};var r=[301,302,303,307,308];o.redirect=function(a,b){if(r.indexOf(b)===-1)throw new RangeError("Invalid status code");return new o(null,{status:b,headers:{location:a}})},a.Headers=e,a.Request=l,a.Response=o,a.fetch=function(a,b){return new Promise(function(c,d){function e(){return"responseURL"in g?g.responseURL:/^X-Request-URL:/m.test(g.getAllResponseHeaders())?g.getResponseHeader("X-Request-URL"):void 0}var f;f=l.prototype.isPrototypeOf(a)&&!b?a:new l(a,b);var g=new XMLHttpRequest;g.onload=function(){var a={status:g.status,statusText:g.statusText,headers:n(g),url:e()},b="response"in g?g.response:g.responseText;c(new o(b,a))},g.onerror=function(){d(new TypeError("Network request failed"))},g.ontimeout=function(){d(new TypeError("Network request failed"))},g.open(f.method,f.url,!0),"include"===f.credentials&&(g.withCredentials=!0),"responseType"in g&&p.blob&&(g.responseType="blob"),f.headers.forEach(function(a,b){g.setRequestHeader(b,a)}),g.send("undefined"==typeof f._bodyInit?null:f._bodyInit)})},a.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(a,b,c){"use strict";var d=c(2),e=d.createStore,f=d.applyMiddleware,g=c(8)["default"],h=c(9),i=e(h.manageUsersReducer,f(g));a.exports=i},function(a,b){"use strict";function c(a){return function(b){var c=b.dispatch,d=b.getState;return function(b){return function(e){return"function"==typeof e?e(c,d,a):b(e)}}}}b.__esModule=!0;var d=c();d.withExtraArgument=c,b["default"]=d},function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var e=c(4),f=c(2).combineReducers,g=c(10),h=function(){var a=[];try{for(var b=document.querySelectorAll("section.user-group"),c=0;c<b.length;c++){var d=b[c],e=parseInt(d.getAttribute("data-user-group-id")),f=d.querySelector(".name").innerHTML;a.push({id:e,title:f})}}catch(g){}return a}();console.log("initialUserGroups",h);var i=function(){var a=[];try{for(var b=document.querySelectorAll("tr.user-row"),c=[],d=0;d<b.length;d++){var e=b[d],f=e.getAttribute("data-user-groups").split(",").map(function(a){return parseInt(a)}),g=e.querySelector(".username").innerHTML,h=e.getAttribute("data-email"),i=e.getAttribute("data-user-id"),j=e.nextElementSibling,k=j.querySelector(".givenName").innerHTML,l=j.querySelector("input.sudo").checked,m=j.querySelector("input.active").checked,n=j.querySelector(".jobTitle").innerHTML,o={};Array.prototype.map.call(e.nextElementSibling.querySelectorAll('input[name="grouproles[]"]'),function(a){var b=a.getAttribute("data-group"),c=a.getAttribute("data-role");o[b]||(o[b]=[]),o[b].push(c)}),c[i]||a.push({id:i,username:g,givenName:k,familyName:"",email:h,active:m,sudo:l,jobTitle:n,userGroups:f,groupRoles:o}),c[i]=!0}}catch(p){}return a}();console.log(i);var j=function(){try{return Array.prototype.map.call(document.querySelector(".create-setting-form .field-group fieldset fieldset").querySelectorAll("label"),function(a){return{name:a.querySelector("span").innerHTML,id:a.querySelector("input").getAttribute("data-role-id"),key:a.querySelector("input").getAttribute("data-role-id")}})}catch(a){return[]}}();console.log(j);var k=[{key:"administrator",title:"Administrator",id:1},{key:"modmore",title:"modmore",id:2},{key:"mgab",title:"MGAB",id:3},{key:"sterc",title:"Sterc",id:4},{key:"sitebuilders",title:"Site Builders",id:5}],l={users:i,userGroups:h,fieldsetRoles:k,roles:j,quickCreate:{username:"",givenName:"",familyName:"",email:"",active:!0,sudo:!0,open:!1,updating:!1,id:void 0,roles:{}}},m=function(a,b){a=a||l.users,console.log(b);var c=0;switch(a.map(function(a,d){a.id==b.id&&(c=d)}),console.log(c),b.type){case e.UPDATE_USER_SUCCESS:var f=g(a,d({},c,{$apply:function(a){return g(a,{$merge:b.user})}}));return console.log(a,f),f;case e.ADD_USER_TO_GROUP:return g(a,d({},c,{$apply:function(a){return g(a,{$merge:{userGroups:g(a.userGroups,{$push:[b.group]})}})}}));case e.REMOVE_USER_FROM_GROUP:return g(a,d({},c,{$apply:function(d){return g(d,{$merge:{userGroups:a[c].userGroups.map(function(a){return a!==b.group?a:void 0}).filter(function(a){return void 0!==a})}})}}));case e.ADD_USER_SUCCESS:if(void 0===b.user.id){var h=0;a.map(function(a,b){h=Math.max(a.id,h)}),b.user.id=h+1}return g(a,{$push:[b.user]});case e.DELETE_USER_SUCCESS:var f=g(a,{$splice:[[c,1]]});return console.log(f),f;case e.DELETE_USER_ERROR:return a;case e.DELETE_USERS_SUCCESS:return g(a,{$set:a.map(function(a,c){return b.users.includes(a.id.toString())?void 0:a}).filter(function(a){return void 0!==a})});case e.ACTIVATE_USERS_SUCCESS:return g(a,{$set:a.map(function(a,c){return b.users.includes(a.id.toString())?g(a,{$merge:{active:!0}}):a})});case e.DEACTIVATE_USERS_SUCCESS:return g(a,{$set:a.map(function(a,c){return b.users.includes(a.id.toString())?g(a,{$merge:{active:!1}}):a})});default:return a}},n=function(a,b){switch(a=a||l.quickCreate,b.type){case e.UPDATE_QUICKCREATE:return console.log(e.UPDATE_QUICKCREATE),g(a,{$merge:b.quickCreate})}return a},o=function(a,b){return a=a||l.fieldsetRoles},p=function(a,b){switch(a=a||l.userGroups,b.type){case e.ADD_USER_GROUP:if(void 0===b.userGroup.id){var c=0;a.map(function(a,b){c=Math.max(a.id,c)}),b.userGroup.id=c+1}return g(a,{$push:[b.userGroup]});case e.SET_USER_GROUPS:return g(a,{$set:b.userGroups})}return a},q=function(a,b){switch(a=a||l.roles,b.type){case e.SET_ROLES:return console.log("setting roles",g(a,{$set:b.roles})),g(a,{$set:b.roles})}return a},r=f({quickCreate:n,users:m,userGroups:p,fieldsetRoles:o,roles:q});b.manageUsersReducer=r},function(a,b,c){a.exports=c(11)},function(a,b,c){(function(b){"use strict";function d(a){return Array.isArray(a)?a.concat():a&&"object"==typeof a?h(new a.constructor,a):a}function e(a,c,d){Array.isArray(a)?void 0:"production"!==b.env.NODE_ENV?j(!1,"update(): expected target of %s to be an array; got %s.",d,a):g("1",d,a);var e=c[d];Array.isArray(e)?void 0:"production"!==b.env.NODE_ENV?j(!1,"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",d,e):g("2",d,e)}function f(a,c){if("object"!=typeof c?"production"!==b.env.NODE_ENV?j(!1,"update(): You provided a key path to update() that did not contain one of %s. Did you forget to include {%s: ...}?",r.join(", "),o):g("3",r.join(", "),o):void 0,k.call(c,o))return 1!==Object.keys(c).length?"production"!==b.env.NODE_ENV?j(!1,"Cannot have more than one key in an object with %s",o):g("4",o):void 0,c[o];var i=d(a);if(k.call(c,p)){var t=c[p];t&&"object"==typeof t?void 0:"production"!==b.env.NODE_ENV?j(!1,"update(): %s expects a spec of type 'object'; got %s",p,t):g("5",p,t),i&&"object"==typeof i?void 0:"production"!==b.env.NODE_ENV?j(!1,"update(): %s expects a target of type 'object'; got %s",p,i):g("6",p,i),h(i,c[p])}k.call(c,l)&&(e(a,c,l),c[l].forEach(function(a){i.push(a)})),k.call(c,m)&&(e(a,c,m),c[m].forEach(function(a){i.unshift(a)})),k.call(c,n)&&(Array.isArray(a)?void 0:"production"!==b.env.NODE_ENV?j(!1,"Expected %s target to be an array; got %s",n,a):g("7",n,a),Array.isArray(c[n])?void 0:"production"!==b.env.NODE_ENV?j(!1,"update(): expected spec of %s to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",n,c[n]):g("8",n,c[n]),c[n].forEach(function(a){Array.isArray(a)?void 0:"production"!==b.env.NODE_ENV?j(!1,"update(): expected spec of %s to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",n,c[n]):g("8",n,c[n]),i.splice.apply(i,a)})),k.call(c,q)&&("function"!=typeof c[q]?"production"!==b.env.NODE_ENV?j(!1,"update(): expected spec of %s to be a function; got %s.",q,c[q]):g("9",q,c[q]):void 0,i=c[q](i));for(var u in c)s.hasOwnProperty(u)&&s[u]||(i[u]=f(a[u],c[u]));return i}var g=c(13),h=c(14),i=c(15),j=c(16),k={}.hasOwnProperty,l=i({$push:null}),m=i({$unshift:null}),n=i({$splice:null}),o=i({$set:null}),p=i({$merge:null}),q=i({$apply:null}),r=[l,m,n,o,p,q],s={};r.forEach(function(a){s[a]=!0}),a.exports=f}).call(b,c(12))},function(a,b){function c(){l&&j&&(l=!1,j.length?k=j.concat(k):m=-1,k.length&&d())}function d(){if(!l){var a=g(c);l=!0;for(var b=k.length;b;){for(j=k,k=[];++m<b;)j&&j[m].run();m=-1,b=k.length}j=null,l=!1,h(a)}}function e(a,b){this.fun=a,this.array=b}function f(){}var g,h,i=a.exports={};!function(){try{g=setTimeout}catch(a){g=function(){throw new Error("setTimeout is not defined")}}try{h=clearTimeout}catch(a){h=function(){throw new Error("clearTimeout is not defined")}}}();var j,k=[],l=!1,m=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];k.push(new e(a,b)),1!==k.length||l||g(d,0)},e.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(a,b){"use strict";function c(a){for(var b=arguments.length-1,c="Minified React error #"+a+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+a,d=0;d<b;d++)c+="&args[]="+encodeURIComponent(arguments[d+1]);c+=" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";var e=new Error(c);throw e.name="Invariant Violation",e.framesToPop=1,e}a.exports=c},function(a,b){"use strict";function c(a){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function d(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de","5"===Object.getOwnPropertyNames(a)[0])return!1;for(var b={},c=0;c<10;c++)b["_"+String.fromCharCode(c)]=c;var d=Object.getOwnPropertyNames(b).map(function(a){return b[a]});if("0123456789"!==d.join(""))return!1;var e={};return"abcdefghijklmnopqrst".split("").forEach(function(a){e[a]=a}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},e)).join("")}catch(f){return!1}}var e=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;a.exports=d()?Object.assign:function(a,b){for(var d,g,h=c(a),i=1;i<arguments.length;i++){d=Object(arguments[i]);for(var j in d)e.call(d,j)&&(h[j]=d[j]);if(Object.getOwnPropertySymbols){g=Object.getOwnPropertySymbols(d);for(var k=0;k<g.length;k++)f.call(d,g[k])&&(h[g[k]]=d[g[k]])}}return h}},function(a,b){"use strict";var c=function(a){var b;for(b in a)if(a.hasOwnProperty(b))return b;return null};a.exports=c},function(a,b,c){(function(b){"use strict";function c(a,c,d,e,f,g,h,i){if("production"!==b.env.NODE_ENV&&void 0===c)throw new Error("invariant requires an error message argument");if(!a){var j;if(void 0===c)j=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var k=[d,e,f,g,h,i],l=0;j=new Error(c.replace(/%s/g,function(){return k[l++]})),j.name="Invariant Violation"}throw j.framesToPop=1,j}}a.exports=c}).call(b,c(12))},function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var e=(c(4),c(7),c(18)),f=c(23),g=React.createClass({displayName:"ManageUsersForm",getInitialState:function(){return{filter:void 0,filterBy:void 0}},render:function(){var a=this,b=this.props,c=b.userGroups.filter(function(b){return void 0===a.state.filterBy||a.state.filterBy==b.id}).map(function(c){return React.createElement(f,d({bulkActions:!0,userGroup:c,key:c.id,filter:a.state.filter,users:b.users.filter(function(a){return a.userGroups.includes(c.id)}),title:c.title},"userGroup",c))});return React.createElement("div",null,React.createElement("div",{id:"manage-user-form__header"},React.createElement(e,{roles:b.roles,userGroups:b.userGroups,fieldsetRoles:b.fieldsetRoles,quickCreate:b.quickCreate,handleFilterBy:function(b){return a.setState({filterBy:isNaN(b)?void 0:b})},handleFilter:function(b){return a.setState({filter:b.length?b:void 0})}})),React.createElement("div",{className:"settings-grid"},c))}});a.exports=g},function(a,b,c){"use strict";function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var e=c(4),f=c(7),g=c(19),h=c(21),i=React.createClass({displayName:"CreateSettingsForm",mixins:[g],getInitialState:function(){return{quickCreateOpen:!1}},componentWillMount:function(){var a=this;f.subscribe(function(){a.setState({quickCreateOpen:f.getState().quickCreate.open})})},render:function(){var a=this,b=this.props;console.log(b);var c=!this.state.quickCreateOpen&&React.createElement("button",{onClick:function(b){return a.setState({quickCreateOpen:!0})}},"Quick ",b.quickCreate.updating?"Update":"Create"," User"),g=!!this.state.quickCreateOpen&&React.createElement(h,b);return React.createElement("form",{ref:"createSettingForm",action:b.quickCreate.updating?"/update/user":"/add/user",method:"post",className:"create-setting-form",onChange:this.updateFormData,onSubmit:function(c){c.preventDefault();var g={},h=[];try{var i=new FormData(a.refs.createSettingForm),j=!0,k=!1,l=void 0;try{for(var m,n=i.entries()[Symbol.iterator]();!(j=(m=n.next()).done);j=!0){var o=m.value;g[o[0]]=o[1],o[0].indexOf("-role")>-1&&h.push(parseInt(o[1].split("|")[0]))}}catch(p){k=!0,l=p}finally{try{!j&&n["return"]&&n["return"]()}finally{if(k)throw l}}}catch(q){for(var r in a.formData)console.log(r),g[r]=a.formData[r],r.indexOf("-role")>-1&&a.formData[r].map(function(a,b){h.push(parseInt(a.split("|")[0]))})}h=[].concat(d(new Set(h)));var s={id:b.quickCreate.id,username:b.quickCreate.username,givenName:b.quickCreate.givenName,familyName:b.quickCreate.familyName,email:b.quickCreate.email,active:b.quickCreate.active,sudo:b.quickCreate.sudo,userGroups:h};b.quickCreate.updating?f.dispatch(e.updateUser(b.quickCreate.id,s)):f.dispatch(e.addUser(s))}},React.createElement("div",{className:"top-bar"},c,React.createElement("a",{className:"button",href:"/add/user"},"Create User")),g)}}),j=React.createClass({displayName:"ManageUserFormHeader",getInitialState:function(){return{}},render:function(){var a=this,b=this.props,c=b.userGroups.map(function(a,b){return React.createElement("option",{key:a.id,value:a.id},a.title)});return React.createElement("header",null,React.createElement("h1",null,"Manage Users"),React.createElement("div",{className:"create-user-module"},React.createElement(i,b)),React.createElement("hr",null),React.createElement("div",null,React.createElement("h3",{id:"search-users"},"Search Users"),React.createElement("form",{action:"#",id:"search",className:"search-settings"},React.createElement("label",{"for":"search-users"},React.createElement("span",{className:"accessibly-hidden"},"Search: "),React.createElement("input",{name:"search-users",id:"search-users",type:"text",placeholder:"Search for any User. We'll try and find them.",onChange:function(b){try{a.props.handleFilter(b.target.value)}catch(c){}}})),React.createElement("div",null,React.createElement("button",{type:"submit"},"Search")),React.createElement("label",{htmlFor:"filter-by"},"Filter ",React.createElement("span",{className:"accessibly-hidden"},"Users")," by",React.createElement("span",{className:"accessibly-hidden"}," User Group"),":"),React.createElement("select",{name:"filter-by",id:"filter-by",onChange:function(a){try{b.handleFilterBy(parseInt(a.target.value))}catch(c){console.log(c)}}},React.createElement("option",{checked:!0,value:""},"All"),c)),React.createElement("p",null,"Below you will users who have logged in recently per user group.")),React.createElement("hr",null))}});a.exports=j},function(a,b,c){a.exports=c(20)},function(a,b){var c,d,e,f;d=function(a){return"checkbox"===a.getAttribute("type")},e=function(a){return null!=a.getAttribute("value")},f=function(a,b){var c;return c=a.indexOf(b),c!==-1?a.splice(c,1):a.push(b),a},c=function(a,b){return d(a)?e(a)?(null==b&&(b=[]),f(b,a.value)):a.checked:a.value},a.exports={componentWillMount:function(){return null!=this.getInitialFormData?this.formData=this.getInitialFormData():this.formData={}},updateFormData:function(a){var b,d,e;if(e=a.target,b=e.getAttribute("name"),null!=b&&(d=c(e,this.formData[b]),this.setFormData(b,d),null!=this.formDataDidChange))return this.formDataDidChange()},setFormData:function(a,b){return this.formData[a]=b},clearFormData:function(){return this.formData={}},resetFormData:function(a){return this.clearFormData(),Object.keys(a).forEach(function(b){return function(c){return b.formData[c]=a[c]}}(this))}}},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(b,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();if(!h)var h=c(22);var i=c(4),j=c(7),k=function(a){function b(){return d(this,b),e(this,Object.getPrototypeOf(b).apply(this,arguments))}return f(b,a),g(b,[{key:"render",value:function(){var a=this.props,b=a.userGroups,c=a.roles,d=[],e=a.quickCreate.roles;console.log("userGroups",b);try{b.map(function(a,b){var f=[];c.map(function(b,c){var d=function(){try{return e[a.id].includes(b.id)}catch(c){return!1}}();f.push(h.createElement("label",{key:c,htmlFor:"user-group-"+a.key+"-roles[]"},h.createElement("input",{type:"checkbox",checked:d,ref:"userGroupEditorRoles",name:"user-group-"+a.key+"-roles[]",value:a.id+"|"+b.id})," ",b.name))}),d.push(h.createElement("fieldset",{key:b},h.createElement("legend",null,a.title),f))})}catch(f){}var g=!!a.quickCreate.updating&&h.createElement("div",null,h.createElement("div",null,h.createElement("button",{type:"submit",formaction:"/duplicate/user",formMethod:"put"},"Duplicate User"),h.createElement("button",{type:"submit",className:"dangerous",formaction:"/user/delete",formMethod:"delete"},"Delete User")),h.createElement("div",null,h.createElement("a",{className:"button",href:"mailto:"+a.quickCreate.email+"?subject=MODX%20Next"},"Email User")));return h.createElement("fieldset",null,h.createElement("legend",null,"Quick ",a.quickCreate.updating?"Update":"Create"," User"),h.createElement("input",{type:"hidden",name:"id",value:a.quickCreate.id}),h.createElement("div",{className:"n field-group"},h.createElement("div",{className:"field-username"},h.createElement("label",{htmlFor:"username",id:"username-label"},"Username"),h.createElement("input",{type:"text",value:a.quickCreate.username,ref:"quickCreateUsername",autoFocus:!a.quickCreate.updating,"aria-describedby":"username-label",name:"username",id:"username",className:"nickname","aria-required":"true","aria-invalid":"false",required:!0})),h.createElement("div",{className:"field-given-name"},h.createElement("label",{htmlFor:"given-name"},"First Name"),h.createElement("input",{type:"text",value:a.quickCreate.givenName,onChange:function(a){j.dispatch(i.updateQuickCreate({givenName:a.target.value}))},ref:"quickCreateGivenName",name:"given-name",id:"given-name",className:"given-name"})),h.createElement("div",{className:"field-family-name"},h.createElement("label",{htmlFor:"family-name"},"Last Name"),h.createElement("input",{type:"text",value:a.quickCreate.familyName,onChange:function(a){j.dispatch(i.updateQuickCreate({familyName:a.target.value}))},ref:"quickCreateFamilyName",name:"family-name",id:"family-name",className:"family-name"})),h.createElement("div",{className:"field-email"},h.createElement("label",{htmlFor:"email"},"Email"),h.createElement("input",{type:"email",value:a.quickCreate.email,autoFocus:a.quickCreate.updating,onChange:function(a){j.dispatch(i.updateQuickCreate({email:a.target.value}))},ref:"quickCreateEmail",name:"email",id:"email",className:"email","aria-required":"true","aria-invalid":"false",required:!0}))),h.createElement("div",{className:"field-group user-group-field user-status-field"},h.createElement("div",{className:"field"},h.createElement("input",{type:"checkbox",checked:a.quickCreate.active,onChange:function(a){j.dispatch(i.updateQuickCreate({active:a.target.checked}))},ref:"quickCreateUserActive",name:"user-active",id:"user-active"}),h.createElement("label",{htmlFor:"user-active"}," Active")),h.createElement("div",{className:"field"},h.createElement("input",{type:"checkbox",checked:a.quickCreate.sudo,
onChange:function(a){j.dispatch(i.updateQuickCreate({sudo:a.target.checked}))},ref:"quickCreateUserSudo",name:"user-sudo",id:"user-sudo"}),h.createElement("label",{htmlFor:"user-sudo"}," Sudo"))),h.createElement("div",null,h.createElement("div",{className:"balanced"},h.createElement("button",{className:"comfortably",type:"submit"},a.quickCreate.updating?"Update":"Create"," User"))),h.createElement("div",{className:"field-group"},h.createElement("fieldset",{className:"field"},h.createElement("legend",null,"User Groups"),h.createElement("p",null,"Users can belong to any number of User Groups. User are assigned Roles that define their priveldges as a member of the User Group. A user can belong to the same User Group with multiple roles."),d)),h.createElement("footer",null,h.createElement("div",null,h.createElement("button",{className:"comfortably",type:"submit"},a.quickCreate.updating?"Update":"Create"," User")),g))}}]),b}(h.Component);b["default"]=k,a.exports=k},function(a,b){a.exports=React},function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var e=c(10),f=c(7),g=c(4),h=c(19),i=(React.createClass({displayName:"SettingTableRowGroup",getInitialState:function(){return{showSettings:!1}},render:function(){var a=this,b=this.props,c=b.user;return React.createElement(l,{user:c,className:"contextual-setting",handleBlur:function(b){return console.log("showSetting",a.state.showSetting)},handleFocus:function(b){return console.log("showSetting",a.state.showSetting)}})}}),React.createClass({displayName:"SettingsGridSectionBulkActionsFieldset",mixins:[h],getInitalState:function(){return{formAction:"",formMethod:"push"}},handleBulkButtonClick:function(a){console.log({formAction:a.target.getAttribute("formaction"),formMethod:a.target.getAttribute("formmethod")}),this.setState({formAction:a.target.getAttribute("formaction"),formMethod:a.target.getAttribute("formmethod")})},render:function(){var a=this,b=this.props,c=b.bulkToggledUsers,d=[],e=[];return Object.keys(c).forEach(function(a){c[a]&&(e.push(a.toString()),d.push(React.createElement("input",{key:a,type:"hidden",name:"bulk-toggle-users[]",value:a})))}),React.createElement("form",{action:"/bulk/actions",method:"post",onChange:this.updateFormData,onSubmit:function(b){try{switch(a.state.formAction){case"/api/users/activate":b.preventDefault(),f.dispatch(g.activateUsers(e));break;case"/api/users/deactivate":b.preventDefault(),f.dispatch(g.deactivateUsers(e));break;case"/api/users/delete":b.preventDefault(),f.dispatch(g.deleteUsers(e))}}catch(c){}}},d,React.createElement("fieldset",null,React.createElement("legend",null,"Bulk Actions"),React.createElement("button",{type:"submit",disabled:!b.emails.length,className:"go",formAction:"/api/users/activate",formMethod:"post",onClick:this.handleBulkButtonClick},"Activate"),React.createElement("button",{type:"submit",disabled:!b.emails.length,className:"danger",formAction:"/api/users/deactivate",formMethod:"post",onClick:this.handleBulkButtonClick},"Suspend"),React.createElement("button",{type:"submit",disabled:!b.emails.length,className:"danger",formAction:"/api/users/delete",formMethod:"delete",onClick:this.handleBulkButtonClick},"Delete"),React.createElement("a",{className:"button",disabled:!b.emails.length,href:"mailto:"+b.emails.join(",")+"?subject=MODX%20Next&body="},"Email"),React.createElement("a",{className:"button",disabled:!b.emails.length,href:"https://modxcommunity.slack.com/messages/@"+b.usernames.join(","),target:"_blank"},"Slack DM")))}})),j=React.createClass({displayName:"SettingsTable",getInitialState:function(){return{userFormsToShow:{}}},handleQuickEdit:function(a,b){b.preventDefault(),b.stopPropagation(),console.log("handleQuickEdit!!!",a)},render:function(){var a,b=this,c=this.props;c.bulkActions&&(a=React.createElement("th",null,React.createElement("input",{type:"checkbox",onChange:function(a){try{b.props.handleBulkAllCheck(a.target.checked)}catch(c){}}})));var f=c.users.map(function(a){return[React.createElement(l,{user:a,userGroup:c.userGroup,bulkToggle:void 0!==c.bulkToggledUsers[a.id]&&c.bulkToggledUsers[a.id],bulkActions:c.bulkActions,handleFocus:function(c){return b.setState({userFormsToShow:e({},d({},a.id,{$set:!0}))})},handleBulkToggle:function(a,b){try{c.handleBulkToggle(a,b)}catch(d){}}}),b.state.userFormsToShow[a.id]?React.createElement(m,{handleQuickEdit:b.handleQuickEdit.bind(null,a),className:"contextual-setting",user:a,userGroup:c.userGroup,colspan:c.bulkActions?"3":"2"}):void 0]});return React.createElement("table",{className:"settings-table"},React.createElement("thead",null,React.createElement("tr",null,a,React.createElement("th",{className:"username"},"User"),React.createElement("th",null,"Active"))),React.createElement("tbody",null,f))}}),k=React.createClass({displayName:"SettingsGridSection",getInitialState:function(){return{bulkToggledUsers:{}}},render:function(){var a=this,b=this.props,c=b.users,f=void 0!==b.minimumUsersBulkAction?b.minimumUsersBulkAction:3,g=c.map(function(b){return a.state.bulkToggledUsers[b.id]?b.email:void 0}).filter(function(a){return a}),h=c.map(function(b){return a.state.bulkToggledUsers[b.id]?b.username:void 0}).filter(function(a){return a});void 0!==b.filter&&b.filter.length&&(c=c.filter(function(a){return a.username.indexOf(b.filter)>-1}));var k=c.length>=f&&React.createElement(i,{bulkToggledUsers:this.state.bulkToggledUsers,emails:g,usernames:h});return!!c.length&&React.createElement("section",{id:"user-group-"+b.userGroup.id},React.createElement("div",null,React.createElement("header",null,React.createElement("h2",null,b.title)),React.createElement("div",{className:"balanced"},React.createElement("a",{className:"button",href:"/add/user?group="+b.userGroup.id,style:{marginBottom:"2em"}},"Create "+b.title+" User")),React.createElement("div",null,k,React.createElement(j,{bulkActions:c.length>=f&&b.bulkActions,users:c,bulkToggledUsers:this.state.bulkToggledUsers,userGroup:b.userGroup,handleBulkToggle:function(b,c){a.setState({bulkToggledUsers:e(a.state.bulkToggledUsers,d({},b,{$set:c}))})},handleBulkAllCheck:function(b){var d={};b&&c.map(function(a){d[a.id]=!0}),a.setState({bulkToggledUsers:d})}}),k),React.createElement("footer",null,React.createElement("p",null,React.createElement("a",{href:"#"},"View all ",b.title," users")))))}}),l=function(a){var b,c=a.user,d="bulk-"+a.userGroup.id+"-"+c.username;return a.bulkActions&&(b=React.createElement("td",null,React.createElement("label",{htmlFor:d,className:"accessibly-hidden"},"Select ",c.username),React.createElement("input",{type:"checkbox",name:d,checked:a.bulkToggle,onChange:function(b){b.stopPropagation();try{a.handleBulkToggle(c.id,b.target.checked)}catch(d){}}}))),React.createElement("tr",{tabIndex:"0",onFocus:function(b){console.log(b.nativeEvent);try{a.handleFocus()}catch(c){}},onBlur:function(b){try{a.handleBlur()}catch(c){}}},b,React.createElement("td",{className:"username"},c.username),React.createElement("td",{className:"shy balanced checkbox"},React.createElement("label",null,React.createElement("span",{className:"accessibly-hidden"},"Active: "),React.createElement("input",{checked:c.active,type:"checkbox",onChange:function(a){return f.dispatch(g.updateUser(c.id,e(c,{$merge:{active:a.target.checked}})))}}))))},m=React.createClass({displayName:"SettingsTableRowForm",mixins:[h],getInitialState:function(){return{asyncAction:void 0}},render:function(){var a=this.props,b=a.user,c=a.userGroup;return console.log("SettingsTableRowForm"),console.log(b),React.createElement("tr",a,React.createElement("td",{colSpan:a.colspan},React.createElement("form",{action:this.state.formAction,method:this.state.formMethod,onChange:this.updateFormData},React.createElement("input",{name:"user_id",type:"hidden",value:b.id}),React.createElement("input",{name:"username",type:"hidden",value:b.username}),React.createElement("div",{className:"friendly-labels"},React.createElement("label",null,"Sudo: ",React.createElement("input",{name:"sudo",checked:b.sudo,type:"checkbox",onChange:function(a){f.dispatch(g.updateUser(b.id,e(b,{$merge:{sudo:a.target.checked}})))}})),React.createElement("label",null,"Active: ",React.createElement("input",{name:"active",checked:b.active,type:"checkbox",onChange:function(a){f.dispatch(g.updateUser(b.id,e(b,{$merge:{active:a.target.checked}})))}}))),React.createElement("p",{className:"subtle balanced oblique"},b.jobTitle),React.createElement("div",null,React.createElement("a",{className:"button"},"Next User")),React.createElement("div",null,React.createElement("a",{className:"button",href:"/update/user/"+b.id,onClick:function(a){a.preventDefault(),f.dispatch(g.updateQuickCreate({username:b.username,givenName:b.givenName,familyName:b.familyName,email:b.email,active:b.active,sudo:b.sudo,open:!0,updating:!0,id:b.id,roles:b.groupRoles}))}},"Quick Edit"),React.createElement("a",{className:"button",href:"/update/user/"+b.id},"Edit")),React.createElement("div",null,React.createElement("button",{type:"submit",formAction:"duplicate/user",className:"save"},"Duplicate"),React.createElement("button",{className:"delete",type:"submit",onClick:function(a){a.preventDefault(),a.stopPropagation(),f.dispatch(g.deleteUser(e(b,{$merge:{user_id:b.id}})))},formMethod:"post",formAction:"/user/delete","data-async-action":"deleteuser"},"Delete"),React.createElement("a",{className:"button",href:"mailto:"+b.email+"?subject=MODX%20Next"},"Email")),React.createElement("div",null,React.createElement("a",{className:"button",href:"https://modxcommunity.slack.com/messages/@"+b.username+"/details/",target:"_blank"},"Slack DM")),React.createElement("div",{style:{marginTop:"1em"}},React.createElement("button",{formAction:"removefromgroup/user",onClick:function(a){a.preventDefault(),f.dispatch(g.removeUserFromGroup(b.id,c.id))}},"Remove from Group"))),React.createElement("footer",{className:"subtle oblique balanced"},React.createElement("p",null,b.givenName," ",b.familyName,"’ last login was Jan 23, 2016 4:52pm from Planet Earth"))))}});a.exports=k}]);